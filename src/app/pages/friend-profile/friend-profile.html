<div class="friend-profile-container">
  <div class="profile-header">
    <button class="back-btn" (click)="goBack()">‚Üê Back to Friends</button>
  </div>

  @if (isLoading()) {
  <div class="loading">Loading friend profile...</div>
  } @else if (error()) {
  <div class="error">{{ error() }}</div>
  } @else if (friendProfile()) {
  <div class="profile-content">
    <div class="profile-main">
      <div class="profile-info">
        <div class="avatar-section">
          <img
            [src]="friendProfile()?.avatarUrl || 'assets/default-avatar.png'"
            [alt]="friendProfile()?.displayName"
            class="profile-avatar"
          />
        </div>

        <div class="info-section">
          <h2>{{ friendProfile()?.displayName || friendProfile()?.username }}</h2>
          <p class="username">@{{ friendProfile()?.username }}</p>

          @if (friendProfile()?.bio) {
          <p class="bio">{{ friendProfile()?.bio }}</p>
          }

          <div class="profile-stats">
            <div class="stat">
              <span class="stat-number">{{ friendProfile()?.movieCount || 0 }}</span>
              <span class="stat-label">Movies</span>
            </div>

            @if (friendProfile()?.joinedDate) {
            <div class="stat">
              <span class="stat-label">Joined:</span>
              <span class="stat-value">{{ friendProfile()?.joinedDate | date:'shortDate' }}</span>
            </div>
            }
          </div>

          @if (friendProfile() && friendProfile()!.favoriteGenres && friendProfile()!.favoriteGenres.length > 0) {
          <div class="favorite-genres">
            <h3>Favorite Genres</h3>
            <div class="genre-tags">
              @for (genre of friendProfile()!.favoriteGenres; track genre) {
              <span class="genre-tag">{{ genre }}</span>
              }
            </div>
          </div>
          }
        </div>
      </div>

      <div class="profile-actions">
        @if (friendshipStatus() === 'friends') {
        <button class="primary-btn" (click)="viewSharedMovies()">
          View Shared Movies
        </button>
        <button class="secondary-btn" (click)="removeFriend()">
          Remove Friend
        </button>
        } @else if (friendshipStatus() === 'pending') {
        <button class="secondary-btn" disabled>
          Friend Request Pending
        </button>
        } @else {
        <button class="primary-btn" (click)="sendFriendRequest()">
          Send Friend Request
        </button>
        }
      </div>
    </div>
  </div>
  }
</div>
