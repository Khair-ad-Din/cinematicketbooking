<!-- Profile Overview -->
<section class="profile-overview">
  @if (currentProfile(); as profile) {
  <div class="profile-header">
    <div class="avatar-container">
      <img
        [src]="profile.avatarUrl || 'assets/default-avatar.png'"
        [alt]="profile.displayName"
        class="profile-avatar"
      />
    </div>
    <div class="profile-info">
      <h2>{{ profile.displayName }}</h2>
      <p class="username">@{{ profile.username }}</p>
      <p class="bio">{{ profile.bio || "No bio yet" }}</p>
    </div>

    <div class="profile-actions">
      @if(!isEditing()) {
      <button (click)="startEditing()" class="edit-btn">Edit Profile</button>
      }
    </div>
  </div>
  }
</section>

@if (isEditing()) {
<!-- Edit Form (shown when editing) -->
<section class="profile-edit-form">
  <h3>Edit Profile</h3>
  <!-- Display Name -->
  <div class="form-group">
    <label for="displayName">Display Name</label>
    <input
      type="text"
      id="displayName"
      [value]="editForm().displayName || ''"
      (input)="updateFormField('displayName', $event)"
      placeholder="Your display name"
      maxlength="50"
    />
  </div>

  <!-- Bio -->
  <div class="form-group">
    <label for="bio">Bio</label>
    <textarea
      id="bio"
      [value]="editForm().bio || ''"
      (input)="updateFormField('bio', $event)"
      placeholder="Tell us about yourself..."
      maxlength="500"
      rows="4"
    ></textarea>
  </div>

  <!-- Favorite Genres -->
  <div class="form-group">
    <label>Favorite Genres</label>
    <div class="genres-grid">
      @for (genre of availableGenres; track genre) {
      <label class="genre-checkbox">
        <input
          type="checkbox"
          [checked]="editForm().favoriteGenres?.includes(genre) || false"
          (change)="toggleGenre(genre, $event)"
        />
        <span>{{ genre }}</span>
      </label>
      }
    </div>
  </div>

  <!-- Privacy Settings -->
  <div class="form-group">
    <label class="privacy-toggle">
      <input
        type="checkbox"
        [checked]="editForm().isPublic || false"
        (change)="updateFormField('isPublic', $event)"
      />
      <span>Make profile public</span>
    </label>
  </div>
  <div class="form-actions">
    <button (click)="saveProfile()" class="btn-primary">Save</button>
    <button (click)="cancelEditing()" class="btn-secondary">Cancel</button>
  </div>
</section>
}

<!-- Statistics -->
<section class="profile-stats">
  @if (profileStats(); as stats) {
  <h3>Your Statistics</h3>
  <div class="stats-grid">
    <div class="stat-item">
      <span class="stat-number">{{ stats.movieCount }}</span>
      <span class="stat-label">Movies Rated</span>
    </div>
    <div class="stat-item">
      <span class="stat-number">{{ stats.friendsCount }}</span>
      <span class="stat-label">Friends</span>
    </div>
    <div class="stat-item">
      <span class="stat-number">{{ stats.joinedDaysAgo }}</span>
      <span class="stat-label">Days Active</span>
    </div>
  </div>
  }
</section>

<!-- Danger Zone -->
<section class="danger-zone">
  <!-- Clear preferences, delete account, etc. -->
  <button (click)="clearPreferences()" class="danger">
    Clear All Movies Preferences
  </button>
</section>
